# 主数据建模

主要包括实体建模、主数据定义、动态建模和主数据编码。实体建模把建模完成的实体发布到动态的主数据节点或者导出Excel模板；动态建模把建模完成的物料模型发布到动态的主数据节点或者导出Excel模板，二者都可以发起新增或修改主数据时的审批流程。

## 实体建模

点击【主数据建模】→【实体建模】，进入实体建模页面，在该页面里，左边是实体的分类树，右边是对实体的新增、修改、删除和导出Excel模板等操作。

![](/articles/mdm/5-/images/image4.png)
 
<p align="center">图：实体建模</p>

**分类树管理**

实体分类树是多级树结构。树根节点默认为“主数据分类”。

➢ 新增分类

单击实体分类树的根节点“主数据分类”，单击〖新增〗弹出窗口，选择“主数据分类”，填写内容（*表示必填项）后，单击〖确定〗。

![](/articles/mdm/5-/images/image5.png)
 
<p align="center">图：新增分类</p>


新增的主数据分类，会出现在分类树下。

➢ 新增实体

单击分类树的子节点，单击〖新增〗弹出窗口，选择“主数据”，填写内容（*表示必填项）后，单击〖确定〗。
 
![](/articles/mdm/5-/images/image6.png)
 
<p align="center">图：新增主数据</p>


如果勾选“启用数据版本”，表示修改主数据后会记录历史版本，方便日后回溯。

如果勾选“流程特性”，表示维护主数据时，需要进行审批。

新增实体后，选择该实体，单击〖新增〗弹出窗口，选择“主表”，增加一个主表，如下图。
 
![](/articles/mdm/5-/images/image7.png)
 
<p align="center">图：新增主表</p>


选择该实体后，单击〖新增〗弹出窗口，选择“子表”，增加一个子表。

实体属性的定义项包括：

1. 字段编码：唯一的英文编码标识别；

2. 字段名称：中文属性名称；

3. 类型：实体数据类型。包括：字符，整型，布尔，浮点型，日期，日期时间，参照，下拉，图片，文件，大文本，时间；

4. 长度：实体类型的数据宽度；

5. 是否必输项；

6. 是否唯一；

7. 查询条件：是否可查询。勾选后，将在主数据节点左侧显示查询框；

8. 默认值：设置此值后，在界面会自动出现。

➢ 显示分类

单击分类树下的某个主数据分类，在右边会出现该分类的信息。

➢ 显示实体

单击分类树下的某个实体，在右边会出现该实体的主子表信息。可以编辑或删除主子表信息。

➢ 修改分类

单击分类树下的某个主数据分类，单击〖修改〗弹出窗口，填写内容（*表示必填项）后，单击〖确定〗。

➢ 删除分类

单击分类树下的某个主数据分类，单击〖删除〗，弹出确认提示。

如果该分类下存在实体的定义，则不能删除该分类，会弹出提示框。

➢ 修改和删除实体

与上述方法相同。

➢ 导出Excel

单击定义树的某个分类下的某个实体，单击〖导出excel模板〗，生成Excel文件（文件名为实体的编码）,包含该实体所包含的实体属性，保存到本地。

![](/articles/mdm/5-/images/image8.png)
 
<p align="center">图：导出Excel</p>

图3.1-5导出Excel

➢ 新增或修改主数据时的审批流程

具体流程请参见【动态建模】部分中“新增或修改物料主数据时的审批流程”。

其中，发布主数据模型在【主数据定义】中点击〖保存并发布〗。

## 主数据定义

点击【主数据建模】→【主数据定义】，进入如下界面，在此页面可进行主数据界面风格的选择、配置参照的编辑和配置下拉框等操作。

![](/articles/mdm/5-/images/image9.png)
 
<p align="center">图：主数据定义</p> 

界面风格：有默认、树表和树卡三种风格。

树表：单击〖树表〗按钮，出现下图所示窗口，选择内容后，单击〖保存并发布〗或者〖反发布〗。

![](/articles/mdm/5-/images/image10.png)
 
<p align="center">图：树表</p>

单击〖树卡〗按钮，出现下图所示窗口，选择内容后，单击〖保存并发布〗或者〖反发布〗。

![](/articles/mdm/5-/images/image11.png)
 
<p align="center">图：树卡</p>

 
配置参照：选择一个主数据，单击〖配置参照〗按钮，出现下图所示页面，填写内容，点击〖保存〗。

![](/articles/mdm/5-/images/image12.png)
 
<p align="center">图：配置参照</p>


配置下拉框：选择一个主数据，单击〖配置下拉框〗按钮，出现下图所示页面，填写内容，点击〖保存〗。

![](/articles/mdm/5-/images/image13.png)
 
<p align="center">图：配置下拉框</p>

 


## 动态建模

点击【主数据建模】→【动态建模】，进入动态建模界面，如下图所示：

![](/articles/mdm/5-/images/image14.png)
 
<p align="center">图：动态建模</p>
 

➢ 新增大类

单击左侧主数据分类树的根节点“主数据分类”，单击〖新增〗增加大类，填写内容（*表示必填项）后，单击〖保存〗。

![](/articles/mdm/5-/images/image15.png)
 
<p align="center">图：新增大类</p>


 

大类包括通用属性和扩展属性。

扩展属性：新增的时候可以删除（点击减号），保存之后不可以删除。


➢ 新增小类

单击左侧主数据分类树的大类，单击〖新增〗增加小类，填写内容（*表示必填项）后，单击〖保存〗。

![](/articles/mdm/5-/images/image16.png)
 
<p align="center">图：新增小类</p>
 

新增的小类自动继承大类的通用属性。在新增修改小类时必须参照选择大类的扩展属性。

勾选“流程特性”，表示维护物料主数据时，需要进行审批。

“类型”：字段的类型。

“长度”：字段的长度。

“必输”：勾选以后表示必须输入。

“查询条件”：是否可查询。勾选后，将在主数据节点左侧显示查询框。

“是否唯一”：唯一性判断。

“参照对象”：该字段可参照的其他物料。只有两个类型（参照和下拉）需要配置参照对象。

“显示字段”：下拉或参照类型的字段，参照某个物料主数据，在这里配置维护时显示哪个字段。

“默认值”：如选中，表示维护字段的时候默认有值。

➢ 修改和删除大类

单击左侧主数据分类树的大类，单击〖修改〗和〖删除〗进行相应操作。如果该分类下存在已发布的节点，则不能删除该分类。

![](/articles/mdm/5-/images/image17.png)
 
<p align="center">图：修改删除大类</p>

 
➢ 修改和删除小类

单击左侧主数据分类树的小类，单击〖修改〗和〖删除〗进行相应操作。如果该分类下存在已发布的节点，则不能删除该分类。

![](/articles/mdm/5-/images/image18.png)
 
<p align="center">图：修改删除小类</p> 

➢ 发布小类

单击左侧主数据分类树的小类，单击〖发布〗按钮进行发布。发布的小类也可以单击〖反发布〗按钮取消发布。

![](/articles/mdm/5-/images/image19.png)
 
<p align="center">图：发布小类</p>

 

➢ 导出Excel

单击定义树的某个小类，单击〖导出excel模板〗，生成Excel文件（文件名为实体的编码）,包含该小类所包含的实体属性，保存到本地。

➢ 新增或修改物料主数据时的审批流程

有物料主数据权限的用户都可以发起审批流程。

如果没有权限，系统管理员登录，在【管理中心】→【角色管理】中有内置的“主数据管理类角色”，在【角色分配用户】节点将这个角色分配给相关人员。

设置审批的具体流程如下：

（1）	点击【主数据建模】→【动态建模】，选择物料大类，单击〖新增〗，勾选〖流程特性〗，如下图所示：

![](/articles/mdm/5-/images/image20.png)
 
<p align="center">图：新增物料小类</p>
 

（2）	选择该物料小类，单击〖发布〗，发布物料主数据模型。

（3）	设计流程模型（由系统管理员进行设计）。

a.	点击【管理中心】→【流程模型】，如下图：

![](/articles/mdm/5-/images/image21.png)
 
<p align="center">图：配置流程模型</p>



b.	单击〖新建分组〗，然后在该分组下单击〖新增流程〗，新增流程模型。“模型”参照选择刚才发布的物料小类。

![](/articles/mdm/5-/images/image22.png)
 
<p align="center">图：新增流程模型</p>

 

c.	对新建的流程进行设计。鼠标放置到流程行，显示〖设计〗按钮并点击，进入流程设计界面。

![](/articles/mdm/5-/images/image23.png)
 
<p align="center">图：进入设计界面</p>

 

![](/articles/mdm/5-/images/image24.png)
 
<p align="center">图：流程设计</p>
 

绿色圆点为流程起点，红色圆点为流程终点。将左上角〖审批任务〗拉入界面，新增一个审批任务。然后点击箭头进行连接。
![](/articles/mdm/5-/images/image25.png)
 
<p align="center">图：新增审批任务</p>


点击流程中的一个〖审批任务〗，在右侧属性栏选择设置审批部门和审批用户，支持选择多部门和多用户，单击〖确定〗。

![](/articles/mdm/5-/images/image26.png)
 
<p align="center">图：设置审批用户</p>


审批模式：如果选择“会签”，表示所有审批人都要完成审批，才能进入下一步审批任务；如果选择“抢占”，表示有一个审批人完成审批后，其他人员无需进行审批，直接进入下一步审批任务。

流程设置完成，单击左上角〖保存模型〗。

d.	单击〖发布〗，发布流程模型。

![](/articles/mdm/5-/images/image27.png)
 
<p align="center">图：发布流程模型</p>

 

（4）	发布流程模型之后，有物料主数据权限的用户就可以发起“新增或修改物料主数据”的审批流程。审批人员在【应用中心】→【流程管理】→【任务中心】，查看待办任务，点击任务进行审批。

![](/articles/mdm/5-/images/image28.png)
 
<p align="center">图：任务审批</p>

 

点击〖打开单据〗，如果不同意，审批人可以选择“驳回到环节”，驳回到上一环节或者制单人，或者直接选择“驳回到制单人”。“加签”表示增加一个审批人，“改派”表示本人不用审批，改派到另一人进行审批。点击〖流程图〗查看流程图。

![](/articles/mdm/5-/images/image29.png)
 
<p align="center">图：审批</p>

 

（5）	在【主数据】的物料主数据节点，点击〖审批任务〗查看正在审批中的任务的审批进度，点击〖审批历史〗查看已经审批通过的数据的审批历史。

## 主数据编码

点击【主数据建模】→【主数据编码】，进入主数据编码界面。在该页面里，左边是实体分类树，以便选择实体，右边是该主数据编码的管理界面。

注：物料主数据的编码，既可以设置到大类上，也可以设置到小类上，只能二选一。

![](/articles/mdm/5-/images/image30.png)
 
<p align="center">图：主数据编码</p>

 
主数据编码由以下三种元素类型组成：

1)	常量：即固定值，表示固定字符串和分隔符，长度取字符串长度；

2)	时间：编码规则的时间格式对应的时间；

3)	流水号：主数据的顺序号。

➢ 查看编码规则

单击分类树的某个分类下的某个实体，在页面右边会显示该实体的编码信息，包括：规则编码，规则名称，时间格式，编码长度，编码展示效果，以及编码规则的各元素的组成等。如果该实体未定义编码规则，则各显示项无内容。

➢ 修改编码

单击左侧主数据，单击〖修改〗按钮，完成编辑后按〖确定〗。

![](/articles/mdm/5-/images/image31.png)
 
<p align="center">图：修改编码</p>

 

➢ 删除编码

单击左侧主数据，单击〖删除〗按钮，按〖确定〗进行删除。
